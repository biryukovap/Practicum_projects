# Модель прогнозирования для интернет-магазина

## Модуль "Обучение с учителем: качество модели"

## Описание проекта
Интернет-магазин «██████» продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты. Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться.\
**Задача**: разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.

---

### Данные
#### **`██████.csv`**  
Таблица с данными о поведении покупателя на сайте, маркетинговых взаимодействиях и продуктовом поведении. Содержит ключевые характеристики, влияющие на покупательскую активность, такие как история покупок, количество маркетинговых коммуникаций, длительность использования сервиса и число неоплаченных товаров.

#### **`██████.csv`**  
Таблица с данными о выручке, полученной с покупателя. Отражает, сколько покупатель потратил за различные периоды взаимодействия с сайтом.

#### **`██████.csv`**  
Таблица с данными о времени, которое покупатель провёл на сайте. Помогает оценить вовлечённость клиентов и частоту их посещений.

#### **`██████.csv`**  
Таблица с данными о среднемесячной прибыли покупателя за последние 3 месяца. Показывает, какую прибыль магазин получает от каждого клиента.

---

### Стек технологий
| Категория | Библиотеки / Инструменты |
|-----------|--------------------------|
| **Обработка данных** | `pandas`, `numpy` |
| **Визуализация данных** | `matplotlib.pyplot`, `seaborn`, `shap` |
| **Анализ корреляций** | `phik`, `plot_correlation_matrix` (из `phik.report`) |
| **Машинное обучение** |  
| - Разбиение данных | `train_test_split`, `GridSearchCV`, `RandomizedSearchCV` (из `sklearn.model_selection`) |  
| - Масштабирование данных | `SimpleImputer` (из `sklearn.impute`) |  
| - Построение моделей |  
| -- Логистическая регрессия | `LogisticRegression` (из `sklearn.linear_model`) |  
| -- K-ближайших соседей | `KNeighborsClassifier` (из `sklearn.neighbors`) |  
| -- Константная модель | `DummyClassifier` (из `sklearn.dummy`) |  
| - Пайплайн | `Pipeline` (из `sklearn.pipeline`) |  
| **Метрики моделей** |  
| - Классификация | `roc_auc_score` (из `sklearn.metrics`) |

### Структура проекта
1. **Подготовка данных**
   - Загрузка и первичный анализ структуры датасетов.
   - Обработка пропущенных значений.
   - Приведение типов данных.
   - Создание дополнительных признаков.
2. **Анализ данных**
   - Анализ корреляции между признаками с использованием **phik**.
   - Оценка важности различных факторов.
3. **Построение моделей**
   - Логистическая регрессия (**LogisticRegression**).
   - K-ближайших соседей (**KNeighborsClassifier**).
   - Константная модель (**DummyClassifier**).
   - Пайплайн (**Pipeline**).
   - Разбиение данных на тренировочные и тестовые выборки (**train_test_split**).
   - Подбор гиперпараметров (**GridSearchCV**, **RandomizedSearchCV**).
4. **Оценка модели**
   - Метрики точности для классификационных моделей:
     - **roc_auc_score** — площадь под кривой ошибок.
5. **Визуализация результатов**
   - Построение графиков для визуального анализа данных.
6. **Итоговые выводы и рекомендации**