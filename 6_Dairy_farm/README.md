# Построение модели по управлению рисками для молочного хозяйства
## Модуль "Линейные модели в машинном обучении"

## Описание проекта
Владелец молочного хозяйства «████████████» хочет купить бурёнок, чтобы расширить поголовье стада коров. Для этого он заключил выгодный контракт с ассоциацией пастбищ «████████████».\
\
Условия позволяют фермеру очень тщательно отобрать коров. Он определяет качество молока по строгой методике, и при этом ему нужно выполнять свой план развития молочного хозяйства. Фермер хочет, чтобы каждая бурёнка давала не менее 6000 килограммов молока в год, а её надой был вкусным — строго по его критериям, ничуть не хуже.\
\
**Задача**: разработать модель машинного обучения, которая поможет фермеру управлять рисками и принимать объективное решение о покупке. Нужно создать две прогнозные модели для отбора бурёнок в поголовье:
- Первая будет прогнозировать возможный удой коровы (целевой признак Удой);
- Вторая — рассчитывать вероятность получить вкусное молоко от коровы (целевой признак Вкус молока).
С помощью модели нужно отобрать коров по двум критериям:
- средний удой за год — не менее 6000 килограммов;
- молоко должно быть вкусным.

---

### Данные
Проект использует три основных набора данных:
- информация о текущем стаде фермера, включая удои, состав молока, породу, возраст коров и тип пастбища.
- данные о родословной стада, включая уникальные идентификаторы коров и имена их отцов.
- данные о коровах, которые фермер планирует приобрести, включая породу, возраст, тип пастбища и характеристики молока.

---

### Структура проекта
1. Загрузка и изучение данных:
    - загрузка датафреймов
    - форматирование датафреймов в соответствии со стандартами
2. Предобработка данных:
    - обработка пропусков
    - обработка явных и неявных дубликатов
    - корректирование форматов
3. Исследовательский анализ данных:
    - построение графиков и выводы по количественным признакам
    - построение графиков и выводы по категориальным признакам
4. Корреляционный анализ:
    - рассчет взаимосвязи между всеми признаками
    - построение диаграммы рассеяния для признака "удой" и всех количественных признаков с учётом значения категориальных признаков
    - выводы по корреляционному анализу
5. Обучение модели линейной регрессии
    - первая модель:
        - построение и обучение модели
        - оценка метрики R²
        - анализ остатков
        - выводы
     - вторая модель:
         - построение и обучение модели с учетом выводов о первой модели
         - оценка метрики R²
         - анализ остатков
         - выводы
     - третья модель:
         - построение и обучение модели с учетом выводов о второй модели
         - оценка метрики R²
         - анализ остатков
         - выводы
     - общий вывод о моделях:
         - сравнение метрики R² и анализа остатков
         - сравнение MSE, MAE, RMSE
         - выбор лучшей модели
         - рассчет доверительного интервала для лучшей модели
     - прогноз удоя коров "ЭкоФермы":
         - добавление в данные недостающих признаков
         - обучение модели на полных данных и применение к реальным данным
         - вывод результатов
6. Обучение модели логистической регрессии:
    - первичная модель:
        - построение и обучение модели
        - оценка метрик accuracy, recall и precision
        - построение confusion matrix
        - выводы по модели
    - доработка модели
    - применение к реальным данным
    - вывод результатов
7. Итоговые выводы

---

### Стек технологий
| Категория | Библиотеки / Инструменты |
|-----------|--------------------------|
| **Обработка данных** | `pandas`, `numpy` |
| **Визуализация данных** | `matplotlib.pyplot`, `seaborn` |
| **Анализ корреляций** | `phik` |
| **Машинное обучение** |  
| - Разбиение данных | `train_test_split` (из `sklearn.model_selection`) |  
| - Масштабирование данных | `StandardScaler` (из `sklearn.preprocessing`) |  
| - Построение моделей | `LogisticRegression` (из `sklearn.linear_model`), `LinearRegression` (из `sklearn.linear_model`) |  
| **Метрики моделей** |  
| - Регрессия | `mean_squared_error`, `mean_absolute_error`, `r2_score` (из `sklearn.metrics`) |  
| - Классификация | `accuracy_score`, `recall_score`, `precision_score`, `confusion_matrix` (из `sklearn.metrics`) |  
